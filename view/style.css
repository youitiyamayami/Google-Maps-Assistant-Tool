/* =========================================
 * style.css（スクロール対応版）
 * 目的:
 *  - 固定サイズ/絶対配置を撤廃し、内容に応じて伸縮・スクロール可能にする
 *  - 既存の UI/機能は維持（ID/DOM 構造は変更しない）
 * ========================================= */

/* ベーステーマ変数 */
:root{
  --h-control: 52px;
  --gap: 12px;
  --radius: 8px;
  --border: 1px solid #ccc;
  --bg: #f5f7fb;
  --panel: #fff;
  --shadow: 0 10px 30px rgba(0,0,0,0.08);
  --font: system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans JP', sans-serif;

  /* レイアウト */
  --page-max-width: 960px;
  --page-padding: 20px;
}

*{ box-sizing: border-box; }

/* ページ全体をスクロール可能に */
html{
  min-height: 100%;
  background: var(--bg);
  scroll-behavior: smooth;
}
body{
  margin: 0;
  min-height: 100vh;
  font-family: var(--font);
  color: #111;
  /* ← 固定幅/高さ・overflow:hidden を削除して縦スクロール可能に */
}

/* コンテナ: 中央寄せ + パネル表示（可変高さ） */
#app{
  width: 100%;
  max-width: var(--page-max-width);
  margin: 24px auto;
  padding: var(--page-padding);
  background: var(--panel);
  border: var(--border);
  border-radius: 12px;
  box-shadow: var(--shadow);
}

/* 見出し */
h1{ margin: 0 0 16px; font-size: 20px; }
h2{ margin: 0 0 6px; font-size: 18px; }

/* アクセシビリティ用隠しラベル */
.visually-hidden{
  position: absolute !important; height: 1px; width: 1px; overflow: hidden;
  clip: rect(1px, 1px, 1px, 1px); clip-path: inset(50%); white-space: nowrap;
  border: 0; padding: 0; margin: -1px;
}

/* セクション: 通常フローで縦並び（絶対配置を廃止） */
#Departure, #Waypoint, #Arrive, #Options, #Actions{
  position: static;           /* ← 以前の absolute を撤廃 */
  width: auto;
  display: grid;
  grid-template-columns: 1fr;
  row-gap: 8px;
  margin-top: 16px;           /* セクション間の余白 */
}

/* 入力行（フォームで2カラム） */
#Departure form, #Waypoint form, #Arrive form{
  display: grid;
  grid-template-columns: 1fr 160px;
  column-gap: var(--gap);
}
#Departure input[type="text"],
#Waypoint  input[type="text"],
#Arrive    input[type="text"]{
  height: var(--h-control);
  border: var(--border);
  border-radius: var(--radius);
  padding: 0 12px;
  font-size: 16px;
  width: 100%;
}
#Departure button, #Waypoint button, #Arrive button{
  height: var(--h-control);
  border: var(--border);
  border-radius: var(--radius);
  background: #f3f3f3;
  cursor: pointer;
}
.selection-preview{ margin: 0; font-size: 12px; color: #333; }

/* オプション */
.options-grid{
  display: grid;
  grid-template-columns: 220px 180px;
  column-gap: var(--gap);
  align-items: end;
}
.field label{ display: block; font-size: 12px; color: #444; margin-bottom: 4px; }
.field input[type="date"], .field input[type="time"]{
  height: var(--h-control); border: var(--border); border-radius: var(--radius);
  padding: 0 10px; font-size: 14px;
}

/* 実行行 */
.action-row{ display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
.note{ font-size: 12px; color: #666; }

/* URLプレビュー（共通） */
.url-preview-row{ margin-top: 12px; display: grid; row-gap: 6px; }
.url-preview-row label{ font-size: 12px; color: #444; }
.url-preview{
  display: grid;
  grid-template-columns: 1fr 120px;
  column-gap: var(--gap);
}
#url-preview, #url-preview-leg1{
  height: var(--h-control); border: var(--border); border-radius: var(--radius);
  padding: 0 10px; font-size: 14px; width: 100%;
}

/* 保存結果 */
.save-result-row{ margin-top: 10px; display: grid; row-gap: 6px; }
.save-result-row label{ font-size: 12px; color: #444; }
#save-result, #save-result-leg1{
  width: 100%; min-height: 92px; resize: vertical;
  border: var(--border); border-radius: var(--radius); padding: 8px 10px; font-size: 13px;
  background: #fafafa;
}

/* ボタン */
.btn{
  display: inline-flex; align-items: center; justify-content: center;
  text-decoration: none; border: var(--border); border-radius: var(--radius);
  padding: 0 20px; height: var(--h-control); cursor: pointer; user-select: none;
}
.btn-lg{ height: calc(var(--h-control) + 6px); padding: 0 24px; font-size: 16px; }
.btn-primary{ background: #0b57d0; color: #fff; border-color: #0b57d0; }
.btn:hover{ filter: brightness(1.03); }
.btn:active{ transform: translateY(1px); }
button[disabled]{ opacity: 0.55; cursor: not-allowed; }

/* 候補ポップアップ: 画面スクロールに追従するよう fixed に */
#box{
  position: fixed;           /* ← absolute から fixed に変更 */
  left: 50%;
  top: 10%;
  transform: translateX(-50%);
  width: min(720px, 90vw);
  max-height: 80vh;          /* ビューポート基準でスクロール可 */
  background: #fff; border: 1px solid #333; box-shadow: 0 10px 10px #999;
  border-radius: 10px; padding: 16px 16px 12px; overflow: auto; z-index: 9999;
  display: none; text-align: left; font-family: serif;
}
#close{
  position: sticky;          /* スクロールしても右上に残る */
  float: right;
  top: 0; right: 0;
  width: 32px; height: 32px;
  border: 0; border-radius: 6px; background-color: #EEE; color: #333; cursor: pointer;
}
.popup-title{ margin: 0 0 8px; font-size: 16px; }
.search-summary{ font-size: 12px; color: #333; margin-bottom: 6px; }
.search-results{ list-style: none; margin: 0; padding: 0; }
.result-item{
  display: grid; grid-template-columns: 1fr; row-gap: 4px;
  border-bottom: 1px dashed #ccc; padding: 8px 4px; cursor: pointer;
}
.result-item:focus, .result-item:hover{ background: #f7f7f7; }
.result-item .title{ font-weight: 700; }
.result-item .snippet{ font-size: 12px; color: #444; }
.result-item .meta{ font-size: 12px; color: #666; }
.no-results, .loading{ padding: 16px; color: #666; }

/* モバイル～狭幅調整 */
@media (max-width: 680px){
  .options-grid{ grid-template-columns: 1fr; row-gap: var(--gap); }
  #Departure form, #Waypoint form, #Arrive form{
    grid-template-columns: 1fr; row-gap: var(--gap);
  }
}
